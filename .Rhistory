sapply(ind_vars, reg_decrease)
## Wilcoxon Signed Rank Test
# Scores
# paired_enc <- paired_enc %>% filter(if_all(c(water_collection_time_pre,
#                                             water_collection_time_post),
#                                            ~ !is.na(.)))
pre_scores <- paired_enc$water_collection_time_pre
post_scores <- paired_enc$water_collection_time_post
# Running the test
wilcox.test(pre_scores, post_scores, paired=TRUE)
# Visualize distribution of score differences
diff <- post_scores - pre_scores
hist(diff)
## Sign Test
# Calculating differences
pre_scores <- paired_enc$cooking_fuel_collection_time_pre
post_scores <- paired_enc$cooking_fuel_collection_time_post
diff <- post_scores - pre_scores
# Running the test
signtest(diff, m=0, conf.level=0.95, exact=FALSE)
# Visualize distribution of score differences
hist(diff)
## McNemar's  Test
# Cross tabulation of changes of women business ownership
cross_tab <- table(paired_enc$business_owners_female_pre,
paired_enc$business_owners_female_post)
cross_tab
# Running the test
mcnemar.test(cross_tab)
# Change
paired_enc$biz_female_change <- paired_enc$business_owners_female_pre - paired_enc$business_owners_female_post
# Breakdown by response type and Community
dep_var_mat <- rownames_to_column(as.data.frame.matrix(
prop.table(table(
paired_enc$community_post,
paired_enc$biz_female_change),
margin = 1)
)
, var = "community")
community_data <- merge(x=projects, y=dep_var_mat, by="community")
reg_df <- community_data
reg_df <- community_data %>% filter(community != "kalobeyei_settlement")
names(reg_df)[7] <- "var_decrease"
names(reg_df)[8] <- "var_neutral"
names(reg_df)[9] <- "var_increase"
#
ind_vars <- reg_df[c(4:6)]
## Linear Regression t-Test
# Model with increase
reg_increase <- function(feature) {
## Fitting the model with reported increase
# PV Size (kwH)
lm <- lm(var_increase ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, var_increase)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
reg_decrease <- function(feature) {
## Fitting the model with reported increase
# PV Size (kwH)
lm <- lm(var_decrease ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, var_decrease)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
sapply(ind_vars, reg_increase)
sapply(ind_vars, reg_decrease)
# Running the paired t-test
light_hours_pre <- paired_clean$light_hours_current_pre
light_hours_post <- paired_clean$light_hours_current_post
t.test(light_hours_pre, light_hours_post,
paired = TRUE, alternative = "two.sided")
# Isolate the dependent variable
var <- ci_clean$operations_hours_change
work_hours <- var[var != ""]
tab1(work_hours,
sort.group = "decreasing",
cum.percent = TRUE)
# Breakdown by response type and Community
dep_var_mat <- rownames_to_column(as.data.frame.matrix(
prop.table(table(
ci_clean$community,
ci_clean$operations_hours_change),
margin = 1)
)
, var = "community")
community_data <- merge(x=projects, y=dep_var_mat, by="community")
reg_df <- community_data
# reg_df <- community_data %>% filter(community != "kalobeyei_settlement")
ind_vars <- reg_df[c(4:6)]
## Linear Regression t-Test with outlier: kalobeyei_settlement
# Model with increase
reg_increase <- function(feature) {
## Fitting the model with reported increase
# PV Size (kwH)
lm <- lm(yes_they_have_increased ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, yes_they_have_increased)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
reg_decrease <- function(feature) {
## Fitting the model with reported increase
# PV Size (kwH)
lm <- lm(yes_they_have_decreased ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, yes_they_have_decreased)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
sapply(ind_vars, reg_increase)
sapply(ind_vars, reg_decrease)
# Isolate the dependent variable
var <- ci_clean$school_performance
ci_school_performance <- var[var != ""]
tab1(ci_school_performance,
sort.group = "decreasing",
cum.percent = TRUE)
# Breakdown by response type and Community
dep_var_mat <- rownames_to_column(as.data.frame.matrix(
prop.table(table(
ci_clean$community,
ci_clean$school_performance),
margin = 1)
)
, var = "community")
community_data <- merge(x=projects, y=dep_var_mat, by="community")
reg_df <- community_data
## Linear Regression t-Test
reg <- function(feature) {
## Fitting the model with reported increase
lm <- lm(yes_overall_school_performance_is_better ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, yes_overall_school_performance_is_better)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
sapply(ind_vars, reg)
# Isolate the dependent variable
var <- post_clean$school_performance_change
hs_school_performance <- var[var != ""]
tab1(hs_school_performance,
sort.group = "decreasing",
cum.percent = TRUE)
# Breakdown by response type and Community
dep_var_mat <- rownames_to_column(as.data.frame.matrix(
prop.table(table(
post_clean$community,
post_clean$school_performance_change),
margin = 1)
)
, var = "community")
community_data <- merge(x=projects, y=dep_var_mat, by="community")
reg_df <- community_data
# reg_df <- community_data %>% filter(community != "kalobeyei_settlement")
ind_vars <- reg_df[c(4:6)]
## Linear Regression t-Test with outlier: kalobeyei_settlement
# Model with increase
reg_increase <- function(feature) {
## Fitting the model with reported increase
lm <- lm(yes_its_gotten_better ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, yes_its_gotten_better)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
# reg_decrease <- function(feature) {
#   ## Fitting the model with reported increase
#   # PV Size (kwH)
#   lm <- lm(yes_its_gotten_worse ~ feature, data=reg_df)
#   print(summary(lm))
#
#   # Visualizing
#   scatter <- ggplot(data = reg_df,
#                     aes(feature, yes_its_gotten_worse)) +
#                     geom_point(color='blue') +
#                     geom_smooth(color='red', method = "lm", se = FALSE)
#                     theme_classic()
#   ggMarginal(scatter, type = "histogram",
#              xparams = list(fill = 4),
#              yparams = list(fill = 3))
# }
sapply(ind_vars, reg_increase)
# sapply(ind_vars, reg_decrease)
# Breakdown by response type and Community
dep_var_mat <- ci_clean %>%
group_by(community) %>%
summarise(new_health_services = sum(
health_offering_change_count))
community_data <- merge(x=projects, y=dep_var_mat, by="community")
reg_df <- community_data %>% replace(is.na(.), 0)
# reg_df <- community_data %>% filter(community != "kalobeyei_settlement")
ind_vars <- reg_df[c(4:6)]
## Linear Regression t-Test
reg <- function(feature) {
## Fitting the model with reported increase
lm <- lm(new_health_services ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, new_health_services)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
sapply(ind_vars, reg)
## McNemar's  Test
# Cross tabulation of changes of women business ownership
var_pre <- paired_enc$clinic_refrigeration_access_pre
var_post <- paired_enc$clinic_refrigeration_access_post
cross_tab <- table(var_pre,var_post)
cross_tab
# Running the test
mcnemar.test(cross_tab)
# Change
paired_enc$clinic_electricity_change <- var_pre - var_post
# Breakdown by response type and Community
dep_var_mat <- rownames_to_column(as.data.frame.matrix(
prop.table(table(
paired_enc$community_post,
paired_enc$clinic_electricity_change),
margin = 1)
)
, var = "community")
community_data <- merge(x=projects, y=dep_var_mat, by="community")
reg_df <- community_data
reg_df <- community_data %>% filter(community != "kalobeyei_settlement")
names(reg_df)[7] <- "var_decrease"
names(reg_df)[8] <- "var_neutral"
names(reg_df)[9] <- "var_increase"
#
ind_vars <- reg_df[c(4:6)]
## Linear Regression t-Test
# Model with increase
reg_increase <- function(feature) {
## Fitting the model with reported increase
# PV Size (kwH)
lm <- lm(var_increase ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, var_increase)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
reg_decrease <- function(feature) {
## Fitting the model with reported increase
# PV Size (kwH)
lm <- lm(var_decrease ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, var_decrease)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
sapply(ind_vars, reg_increase)
sapply(ind_vars, reg_decrease)
# Breakdown by response type and Community
dep_var_mat <- rownames_to_column(as.data.frame.matrix(
prop.table(table(
paired_clean$community_post,
paired_clean$better_access_health_minigrid),
margin = 1)
)
, var = "community")
community_data <- merge(x=projects, y=dep_var_mat, by="community")
reg_df <- community_data %>% replace(is.na(.), 0)
reg_df <- community_data %>% filter(community != "kalobeyei_settlement")
ind_vars <- reg_df[c(4:6)]
## Linear Regression t-Test
reg <- function(feature) {
## Fitting the model with reported increase
lm <- lm(yes ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, yes)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
sapply(ind_vars, reg)
## McNemar's  Test
# Cross tabulation of changes of women business ownership
var_pre <- paired_enc$clean_drinking_water_pre
var_post <- paired_enc$clean_drinking_water_post
cross_tab <- table(var_pre,var_post)
cross_tab
# Running the test
mcnemar.test(cross_tab)
# Change
paired_enc$clean_water_change <- var_pre - var_post
# Breakdown by response type and Community
dep_var_mat <- rownames_to_column(as.data.frame.matrix(
prop.table(table(
paired_enc$community_post,
paired_enc$clean_water_change),
margin = 1)
)
, var = "community")
community_data <- merge(x=projects, y=dep_var_mat, by="community")
reg_df <- community_data
reg_df <- community_data %>% filter(community != "kalobeyei_settlement")
names(reg_df)[7] <- "var_decrease"
names(reg_df)[8] <- "var_neutral"
names(reg_df)[9] <- "var_increase"
#
ind_vars <- reg_df[c(4:6)]
## Linear Regression t-Test
# Model with increase
reg_increase <- function(feature) {
## Fitting the model with reported increase
# PV Size (kwH)
lm <- lm(var_increase ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, var_increase)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
reg_decrease <- function(feature) {
## Fitting the model with reported increase
# PV Size (kwH)
lm <- lm(var_decrease ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, var_decrease)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
sapply(ind_vars, reg_increase)
sapply(ind_vars, reg_decrease)
# Isolate the dependent variable
var <- ci_clean$clean_drinking_water_access
hs_school_performance <- var[var != ""]
tab1(hs_school_performance,
sort.group = "decreasing",
cum.percent = TRUE)
# Breakdown by response type and Community
dep_var_mat <- rownames_to_column(as.data.frame.matrix(
prop.table(table(
ci_clean$community,
ci_clean$clean_drinking_water_access),
margin = 1)
)
, var = "community")
community_data <- merge(x=projects, y=dep_var_mat, by="community")
reg_df <- community_data
reg_df <- community_data %>% filter(community != "kalobeyei_settlement")
ind_vars <- reg_df[c(4:6)]
## Linear Regression t-Test with outlier: kalobeyei_settlement
# Model with increase
reg_increase <- function(feature) {
## Fitting the model with reported increase
lm <- lm(yes_it_has_increased ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, yes_it_has_increased)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
sapply(ind_vars, reg_increase)
# sapply(ind_vars, reg_decrease)
# Running the paired t-test
kerosene_pre <- paired_clean$kerosene_lamps_count_pre
kerosene_post <- paired_clean$kerosene_lamps_count_post
t.test(kerosene_pre, kerosene_post,
paired = TRUE, alternative = "two.sided")
# Isolate the dependent variable
var <- post_clean$kerosene_lamp_usage_change
kerosene_usage <- var[var != ""]
tab1(kerosene_usage,
sort.group = "decreasing", cum.percent = TRUE)
# Breakdown by response type and Community
dep_var_mat <- rownames_to_column(
as.data.frame.matrix(prop.table(table(post_clean$community,
post_clean$kerosene_lamp_usage_change),
margin = 1)
)
, var = "community")
community_data <- merge(x=projects,
y=dep_var_mat, by="community")
reg_df <- community_data
reg_df <- community_data %>% filter(community != "kalobeyei_settlement")
ind_vars <- reg_df[c(4:6)]
## Linear Regression t-Test
# Model with increase
reg_increase <- function(feature) {
## Fitting the model with reported increase
# PV Size (kwH)
lm <- lm(yes_its_increased ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, yes_its_increased)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
reg_decrease <- function(feature) {
## Fitting the model with reported increase
# PV Size (kwH)
lm <- lm(yes_its_decreased ~ feature, data=reg_df)
print(summary(lm))
# Visualizing
scatter <- ggplot(data = reg_df,
aes(feature, yes_its_decreased)) +
geom_point(color='blue') +
geom_smooth(color='red', method = "lm", se = FALSE)
theme_classic()
ggMarginal(scatter, type = "histogram",
xparams = list(fill = 4),
yparams = list(fill = 3))
}
sapply(ind_vars, reg_increase)
sapply(ind_vars, reg_decrease)
pre_scores <- paired_enc$feel_safe_dark_pre
post_scores <- paired_enc$feel_safe_dark_post
diff <- post_scores - pre_scores
# Running the test
# wilcox.test(pre_scores, post_scores, paired=TRUE)
signtest(diff, m=0, conf.level=0.95, exact=FALSE)
# Visualize distribution of score differences
hist(diff)
# Running the paired t-test
ct <- "nigeria"
ct
df <- paired_clean %>% filter(country_post == ct)
income_pre <- df$avg_household_income_pre
income_post <- df$avg_household_income_post
t.test(income_pre, income_post,
paired = TRUE, alternative = "two.sided")
ct <- "kenya"
ct
df <- paired_clean %>% filter(country_post == ct)
income_pre <- df$avg_household_income_pre
income_post <- df$avg_household_income_post
t.test(income_pre, income_post,
paired = TRUE, alternative = "two.sided")
# Isolate the dependent variable
var <- post_hs$household_income_change
